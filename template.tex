% Author: Castamere
\documentclass[UTF8, a4paper, 12pt, AutoFakeBold, twoside]{ctexart} % 使用ctex以支持中文字符

\usepackage{titling}
\title{智能知识侦察助手}

% MARK: 字体字号
\usepackage{geometry}
\setmainfont{Times New Roman}
\newcommand{\sanhao}{\fontsize{16pt}{24pt}\selectfont}
\newcommand{\xiaosan}{\fontsize{15pt}{22.5pt}\selectfont}
\newcommand{\sihao}{\fontsize{14pt}{21pt}\selectfont}
\newcommand{\xiaosi}{\fontsize{12pt}{18pt}\selectfont}
\newcommand{\wuhao}{\fontsize{10.5pt}{15.75pt}\selectfont}
\newcommand{\xiaowu}{\fontsize{9pt}{13.5pt}\selectfont}

\renewcommand\CJKrmdefault{SimSun(0)}
\setCJKmainfont{simsun.ttc}[AutoFakeBold]
\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\linespread{1.5}

% MARK: 章节命名
\ctexset{
	section={
		name={第,章},
		format=\raggedright\sanhao\heiti,
		beforeskip=0.5ex,
		afterskip=0ex,
		aftername=\enspace,
        number=\arabic{section},
	},
	subsection={
		format=\raggedright\sihao\heiti,
		beforeskip=1ex,
		afterskip=1ex,
		aftername=\enspace,
        number=\arabic{section}.\arabic{subsection},
	},
	subsubsection={
		format=\raggedright\xiaosi\heiti,
		beforeskip=0ex,
		afterskip=0ex,
		aftername=\enspace,
        number=\arabic{section}.\arabic{subsection}.\arabic{subsubsection},
	},
	contentsname={\begin{center}\heiti\sanhao\bfseries{目 \quad 录}\end{center}}
}

% MARK: 目录相关
\usepackage{tocloft}
\setlength\cftbeforetoctitleskip{0ex}
\setlength\cftaftertoctitleskip{0ex}
\setlength\cftbeforepartskip{0ex}
\setlength\cftbeforesecskip{0ex}
\renewcommand{\cftsecfont}{\xiaosi\heiti}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftsubsecfont}{\wuhao\songti}
\renewcommand{\cftsubsubsecfont}{\wuhao\fangsong}

% MARK: 页眉页脚
\usepackage{fancyhdr}

\fancypagestyle{tocstyle}{
	\fancyhf{}
	\renewcommand{\headrulewidth}{0pt}
	\fancyfoot[C]{\xiaowu\thepage}
}

\fancypagestyle{mainstyle}{
	\fancyhf{}
    \setlength{\headheight}{15.75pt}
	\renewcommand{\headrulewidth}{0.3pt}
	\fancyhead[CO]{\wuhao\texttt{浙江理工大学本科毕业设计（论文）}}
	\fancyhead[CE]{\wuhao\texttt{\thetitle}}
	\fancyfoot[CE,CO]{\xiaowu\thepage}
}

% MARK: 引用相关
\RequirePackage{natbib}
\bibliographystyle{references/castamere}
\bibpunct{[}{]}{;}{s}{,}{,} % 第一，二个参数为括号样式，可以换成小括号
\usepackage[hidelinks]{hyperref} % 用于超链接
\newcommand{\fullcite}[1]{(\citeauthor{#1}, \citeyear{#1})\cite{#1}} % 自定义引用指令
\renewcommand{\refname}{\begin{center} \heiti\sanhao 参考文献 \end{center}}

% MARK: 图表公式

% 公式
\usepackage{amsmath}

% 图

% 表
\usepackage{booktabs, multirow, longtable, array, multicol}

% 编号与命名
\usepackage{caption, graphicx, float}
\graphicspath{{figure/}}

\renewcommand{\figurename}{图}
\renewcommand{\tablename}{表}

\numberwithin{equation}{section}
\numberwithin{figure}{section}
\numberwithin{table}{section}

\renewcommand{\theequation}{\thesection-\arabic{equation}}
\renewcommand{\thefigure}{\thesection-\arabic{figure}}
\renewcommand{\thetable}{\thesection-\arabic{table}}

\DeclareCaptionFont{five}{\zihao{5}\bfseries}
\captionsetup[figure]{labelsep=space,font=five}
\captionsetup[table]{labelsep=space,font=five,position=top}

% MARK: 其他

\usepackage{lipsum} % lipsum
\usepackage{pdfpages} % include pdf pages

\begin{document}

% MARK: 前言
\includepdf[pages=-]{preface/诚信声明.pdf}
\include{preface/abstruct}
\include{preface/toc}

% MARK: 正文
\pagestyle{mainstyle}
\pagenumbering{arabic}

\include{chapter/chapter1}
\include{chapter/chapter2}
\include{chapter/chapter3}
\clearpage

% MARK: 附录
\phantomsection\addcontentsline{toc}{section}{参考文献}
\bibliography{references/references}
\newpage
\include{appendice/thanks}
\include{appendice/appendice}

\end{document}